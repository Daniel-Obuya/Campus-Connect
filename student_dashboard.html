<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Dashboard - Campus Connect</title>
    <link rel="stylesheet" href="dashboard_styles.css">
    <link rel="stylesheet" href="department_admin.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="floating-icons-container">
        <div class="floating-icon icon1"></div>
        <div class="floating-icon icon2"></div>
        <div class="floating-icon icon3"></div>
        <div class="floating-icon icon4"></div>
        <div class="floating-icon icon5"></div>
        <div class="floating-icon icon6"></div>
    </div>

    <header class="header">
        <div class="header-left">
            <img src="images/logo 1.png" alt="Campus Connect Logo" class="logo" style="height: 60px; width: 60px;">
            <div class="brand-name">Campus Connect</div>
        </div>
        <div class="page-title">Student Dashboard</div>
        <div class="header-actions">
            <a href="student-profile.html" class="header-button" title="Profile"><span style="font-size:1.2em;">üë§</span> Profile</a>
            <a href="clubs-directory.html" class="header-button">Clubs</a>
            <a href="events_directory.html" class="header-button">Events</a>
            <a href="projects_directory.html" class="header-button">Projects</a>
            <a href="departments_directory.html" class="header-button">Departments</a>
            <button id="notification-icon" class="header-button notification-bell" title="Notifications" style="position:relative; background:transparent; box-shadow:none;">
                <span style="font-size: 1.3em;">üîî</span>
                <span id="notification-count" style="position:absolute;top:2px;right:2px;background:#ff9800;color:#fff;font-size:12px;border-radius:50%;padding:2px 6px;min-width:18px;text-align:center;">0</span>
            </button>
            <a href="welcome.html" class="action-button header-button action-button-danger" id="logoutButton">Logout</a>
        </div>
    </header>

    <style>
   
    .header-left {
        display: flex;
        align-items: center;
        gap: 16px;
    }
    .logo {
        border-radius: 50%;
        background: #fff;
        box-shadow: 0 2px 8px rgba(205,133,63,0.08);
    }
    .brand-name {
        font-size: 1.5rem;
        font-weight: 700;
        color: #8b4513;
        letter-spacing: 1px;
    }
    .page-title {
        font-size: 1.3rem;
        font-weight: 600;
        color: #333;
        text-align: center;
        flex: 1;
    }
    .header-actions {
        display: flex;
        align-items: center;
        gap: 12px;
    }
    .header-button {
        padding: 10px 18px;
        border-radius: 8px;
        font-size: 1rem;
        font-weight: 600;
        background: linear-gradient(135deg, #ffc107, #ff9800);
        color: #333;
        border: none;
        text-decoration: none;
        transition: background 0.2s;
        box-shadow: 0 2px 8px rgba(255,193,7,0.12);
        cursor: pointer;
        display: flex;
        align-items: center;
        position: relative;
    }
    .header-button:hover, .header-button:focus {
        background: linear-gradient(135deg, #ff9800, #ffc107);
        color: #222;
        outline: none;
    }
    .notification-bell {
        background: transparent;
        box-shadow: none;
        padding: 0 10px;
        min-width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    .notification-bell:hover {
        background: #ffe0b2;
    }
    .action-button-danger {
        background: linear-gradient(135deg, #ff5252, #ff9800);
        color: #fff;
    }
    .action-button-danger:hover, .action-button-danger:focus {
        background: linear-gradient(135deg, #ff9800, #ff5252);
        color: #fff;
    }
    body { padding-top: 100px; }
    @media (max-width: 700px) {
        .header { flex-direction: column; height: auto; padding: 12px; }
        .page-title { font-size: 1rem; }
        .brand-name { font-size: 1.1rem; }
        .header-actions { gap: 6px; }
    }
    @media (max-width: 900px) {
        .header-actions { flex-wrap: wrap; gap: 6px; }
        .header-button { font-size: 0.95rem; padding: 8px 10px; }
    }
    </style>

    <main class="dashboard-grid">
        <section id="profile-completion-widget" class="dashboard-widget profile-widget">
            <div class="widget-header">
                <h2>
                    <span class="widget-icon">üìä</span>
                    Profile Status
                </h2>
            </div>
            <div class="progress-bar-container">
                <div id="profile-progress" style="width: 0%">
                    <span class="progress-text">0%</span>
                </div>
            </div>
            <p class="widget-action">
                <a href="edit-student-profile.html" class="action-link">
                    Complete your profile
                    <span class="arrow">‚Üí</span>
                </a>
            </p>
        </section>

        <section id="personalized-feed" class="dashboard-widget feed-widget">
            <div class="widget-header">
                <h2>
                    <span class="widget-icon">üì∞</span>
                    Your Feed
                </h2>
            </div>
            <div class="loading-state">
                <div class="loading-spinner"></div>
                <p>Loading feed...</p>
            </div>
        </section>

        <aside class="sidebar-widgets">
            <section id="events-calendar-widget" class="dashboard-widget calendar-widget">
                <div class="widget-header">
                    <h2>
                        <span class="widget-icon">üìÖ</span>
                        Upcoming Events
                    </h2>
                </div>
                <div id="calendar-placeholder">
                    <div class="loading-state">
                        <div class="loading-spinner"></div>
                        <p>Loading calendar...</p>
                    </div>
                </div>
            </section>

            <section id="recent-announcements" class="dashboard-widget announcements-widget">
                <div class="widget-header">
                    <h2>
                        <span class="widget-icon">üì¢</span>
                        Announcements
                    </h2>
                </div>
                <div class="loading-state">
                    <div class="loading-spinner"></div>
                    <p>Loading announcements...</p>
                </div>
            </section>
        </aside>

        <section id="project-showcase-quick-access" class="dashboard-widget projects-widget">
            <div class="widget-header">
                <h2>
                    <span class="widget-icon">üöÄ</span>
                    Project Showcase
                </h2>
            </div>
            <p class="widget-description">Discover amazing student projects and showcase your own work.</p>
            <p class="widget-action">
                <a href="projects_directory.html" class="action-link">
                    View All Projects
                    <span class="arrow">‚Üí</span>
                </a>
            </p>
        </section>

        <section id="discover-clubs-widget" class="dashboard-widget clubs-widget">
            <div class="widget-header">
                <h2>
                    <span class="widget-icon">üé≠</span>
                    Discover Clubs
                </h2>
            </div>
            <p class="widget-description">Explore a wide range of student clubs and organizations. Find your community!</p>
            <a href="clubs-directory.html" class="action-button">
                <span>View All Clubs</span>
                <span class="button-arrow">‚Üí</span>
            </a>
        </section>

        <section id="explore-departments-widget" class="dashboard-widget departments-widget">
            <div class="widget-header">
                <h2>
                    <span class="widget-icon">üèõÔ∏è</span>
                    Departments
                </h2>
            </div>
            <p class="widget-description">Explore the academic departments and their offerings.</p>
            <a href="departments_directory.html" class="action-button">
                <span>View All Departments</span>
                <span class="button-arrow">‚Üí</span>
            </a>
        </section>

        <div id="notification-center-panel" class="notification-panel">
            <div class="notification-header">
                <h3>Notifications</h3>
                <button class="close-notifications">‚úï</button>
            </div>
            <ul id="notification-list"></ul>
        </div>
    </main>

    <footer>
        <p>&copy; Campus Connect <span id="current-year"></span></p>
    </footer>

    <script src="dashboard_script.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const welcomeMessage = document.getElementById('welcome-message');
            let currentUser = null;

            try {
                // Attempt to get user data from localStorage
                currentUser = JSON.parse(localStorage.getItem('currentUser'));
            } catch (e) {
                console.error('Could not parse user data from localStorage:', e);
                // If data is corrupted, treat as not logged in
            }

            // Check if a valid student user is logged in
            if (currentUser && currentUser.role === 'student' && currentUser.firstName) {
                welcomeMessage.textContent = `Welcome, ${currentUser.firstName}! üëã`;
        // Display profile picture
        const avatar = document.querySelector('.profile-avatar-header');
        if (avatar && currentUser.profilePictureUrl) {
            avatar.src = currentUser.profilePictureUrl;
        }
            } else {
                // If not logged in or not a student, redirect to the login page
                console.warn('No valid student user found. Redirecting to login.');
                window.location.href = '/login-student.html';
                return; // Stop script execution
            }

            // Add entrance animation
            welcomeMessage.style.opacity = '0';
            welcomeMessage.style.transform = 'translateY(-20px)';
            setTimeout(() => { // Using a timeout to apply transition after initial render
                welcomeMessage.style.transition = 'all 0.6s ease';
                welcomeMessage.style.opacity = '1';
                welcomeMessage.style.transform = 'translateY(0)';
            }, 100);

            // Logout functionality
            document.getElementById('logoutButton').addEventListener('click', function(e) {
                e.preventDefault();
                localStorage.removeItem('authToken');
                localStorage.removeItem('currentUser');
                window.location.href = '/welcome.html'; // Redirect to a neutral welcome page
            });
        });

        // Notification bell opens the notification panel
        const notificationIcon = document.getElementById('notification-icon');
        if (notificationIcon) {
            notificationIcon.addEventListener('click', function() {
                document.getElementById('notification-center-panel').style.display = 'block';
            });
        }
        // Close notification panel
        const closeNotifBtn = document.querySelector('.close-notifications');
        if (closeNotifBtn) {
            closeNotifBtn.addEventListener('click', function() {
                document.getElementById('notification-center-panel').style.display = 'none';
            });
        }
    </script>
</body>
</html>