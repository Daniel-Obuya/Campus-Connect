<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Profile - Campus Connect</title>
    <!-- Link to shared CSS which imports common-header.css -->
    <link rel="stylesheet" href="department_admin.css">
    <style>
        /*
         * Page-specific styles for the student profile.
         * General layout, header, and body styles are now inherited from department_admin.css.
        */
        :root {
            /* These variables are already in department_admin.css, but redefining here for fallback/context */
            --amber: #ffc107;
            --orange: #ff9800;
            --peru: #cd853f;
            --saddle-brown: #8b4513;
        }

        /* Main content container for centering the profile card */
        .profile-main-container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(40px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes slideInLeft {
            from { opacity: 0; transform: translateX(-30px); }
            to { opacity: 1; transform: translateX(0); }
        }
        @keyframes pulseSoft {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }

        .profile-card {
            background: rgba(255, 255, 255, 0.45);
            backdrop-filter: blur(36px);
            border: 2px solid rgba(205, 133, 63, 0.2);
            border-radius: 1.5rem;
            padding: 2rem;
            width: 100%;
            max-width: 42rem;
            margin: 0 auto; /* Center the card within its container */
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            animation: fadeInUp 0.7s cubic-bezier(0.39, 0.575, 0.56, 1.000);
        }

        .profile-header {
            display: flex;
            align-items: center;
            gap: 1.25rem;
            margin-bottom: 2rem;
        }
        .avatar {
            width: 4rem;
            height: 4rem;
            background: rgba(205, 133, 63, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: var(--peru);
        }
        .profile-info h1 {
            font-size: 1.875rem;
            font-weight: bold;
            color: var(--saddle-brown);
            margin-bottom: 0.25rem;
            letter-spacing: 0.025em;
        }
        .profile-info p {
            color: var(--peru);
            font-weight: 500;
        }

        .profile-section { margin-bottom: 2rem; }
        .section-title {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--peru);
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid rgba(205, 133, 63, 0.2);
        }

        .section-icon {
            width: 1.25rem;
            height: 1.25rem;
            color: var(--orange);
        }

        .details-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
        }
        .detail-item {
            background: rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(4px);
            border-radius: 0.75rem;
            padding: 1rem;
            min-height: 3.75rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
            transition: all 0.2s ease;
        }
        .detail-item:hover {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            transform: translateY(-2px);
        }

        .detail-item .icon {
            width: 1.25rem;
            height: 1.25rem;
            color: var(--orange);
            transition: transform 0.2s ease;
        }

        .detail-item:hover .icon { transform: scale(1.1); }
        .detail-content { flex: 1; }
        .detail-label {
            font-weight: 500;
            color: var(--saddle-brown);
            font-size: 0.875rem;
        }

        .detail-value { color: #374151; margin-top: 0.25rem; }
        .detail-value a {
            color: inherit;
            text-decoration: underline;
            font-weight: 500;
            font-size: 0.875rem;
            transition: opacity 0.2s ease;
        }

        .detail-value a:hover { opacity: 0.8; }
        .detail-value.blue a { color: #2563eb; }
        .detail-value.gray a { color: #1f2937; }
        .detail-value.peru a { color: var(--peru); }
        .detail-value.italic { font-style: italic; color: #6b7280; }

        .content-list { list-style: none; }
        .content-item {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(4px);
            border-radius: 0.75rem;
            padding: 1.5rem;
            text-align: center;
            margin-bottom: 1rem;
        }

        .content-item:last-child { margin-bottom: 0; }
        .content-item.placeholder { color: #6b7280; font-style: italic; }
        .content-item-title {
            font-weight: 600;
            color: var(--saddle-brown);
            margin-bottom: 0.5rem;
        }

        .content-item-subtitle {
            color: #6b7280;
            font-size: 0.875rem;
            margin-bottom: 1rem;
        }
        .content-item-button {
            background: linear-gradient(to right, var(--amber), var(--orange));
            color: #1f2937;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .content-item-button:hover {
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        .edit-button {
            display: block;
            margin: 2rem auto 0;
            padding: 0.75rem 2rem;
            background: linear-gradient(to right, var(--amber), var(--orange));
            color: #1f2937;
            border: none;
            border-radius: 0.75rem;
            font-weight: bold;
            font-size: 1.125rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .edit-button:hover {
            color: white;
            transform: translateY(-4px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        .footer-text {
            text-align: center;
            color: #6b7280;
            font-style: italic;
            margin-top: 1.5rem;
            font-size: 0.875rem;
        }

        .loading {
            position: fixed;
            inset: 0;
            background: rgba(245, 222, 179, 0.8); /* Use theme background color with opacity */
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }
        .loading-content { text-align: center; }
        .loading-text {
            animation: pulse 2s infinite;
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--saddle-brown);
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        @media (max-width: 768px) {
            .header-content { flex-direction: column; gap: 1rem; }
            .nav-links { gap: 1rem; }
            .details-grid { grid-template-columns: 1fr; }
            .profile-card { padding: 1.5rem; }
            .profile-header { flex-direction: column; text-align: center; }
        }
    </style>
</head>
<body>
    <!-- Loading indicator -->
    <div id="loading" class="loading">
        <div class="loading-content">
            <div class="loading-text">Loading Profile...</div>
        </div>
    </div>

    <!-- Header now uses shared styles from common-header.css -->
    <header class="header">
        <div class="header-left">
            <img src="images/logo 1.png" alt="Campus Connect Logo" class="logo">
            <div class="brand-name">Campus Connect</div>
        </div>
        <div class="header-actions">
            <a href="student_dashboard.html" class="btn-header btn-header-secondary">Back to Dashboard</a>
            <a href="/welcome" class="btn-header btn-header-danger" id="logoutButton">Logout</a>
        </div>
    </header>

    <main id="main-content" class="profile-main-container" style="display: none;">
        <div class="profile-card">
            <div class="profile-header">
                        <div class="avatar">👤</div>
                        <div class="profile-info">
                            <h1 id="student-name">Student Name</h1>
                            <p>Student at Campus Connect</p>
                        </div>
                    </div>
            <div class="profile-section" style="animation-delay: 100ms;">
                        <h2 class="section-title">
                            <span class="section-icon">👤</span>
                            Personal Information
                        </h2>
                        <div class="details-grid" id="personal-info"></div>
                    </div>
            <div class="profile-section" style="animation-delay: 200ms;">
                        <h2 class="section-title">
                            <span class="section-icon">📅</span>
                            My Registered Events
                        </h2>
                        <ul class="content-list" id="registered-events"></ul>
                    </div>
            <div class="profile-section" style="animation-delay: 300ms;">
                        <h2 class="section-title">
                            <span class="section-icon">👥</span>
                            My Joined Clubs
                        </h2>
                        <ul class="content-list" id="joined-clubs"></ul>
                    </div>
            <div class="profile-section" style="animation-delay: 400ms;">
                        <h2 class="section-title">
                            <span class="section-icon">📁</span>
                            My Active Projects
                        </h2>
                        <ul class="content-list" id="active-projects"></ul>
                    </div>
            <button class="edit-button" id="editProfileButton">Edit Profile</button>
            <p class="footer-text">More profile features and information will be available here soon.</p>
        </div>
    </main>
    <script>
        function createDetailItem(icon, label, value, valueClass = "") {
            return `
                <div class="detail-item">
                    <span class="icon">${icon}</span>
                    <div class="detail-content">
                        <div class="detail-label">${label}:</div>
                        <div class="detail-value ${valueClass}">${value}</div>
                    </div>
                </div>
            `;
        }
        function createContentItem(title, subtitle, buttonText, onClickAction) {
            const buttonHtml = buttonText ? 
                `<button class="content-item-button" onclick="${onClickAction}">${buttonText}</button>` : '';
            return `
                <li class="content-item">
                    <div class="content-item-title">${title}</div>
                    <div class="content-item-subtitle">${subtitle}</div>
                    ${buttonHtml}
                </li>
            `;
        }
        function createPlaceholderItem(message) {
            return `
                <li class="content-item placeholder">
                    <p>${message}</p>
                </li>
            `;
        }
        function renderSocialLink(url, platform, color) {
            if (!url) {
                return '<span class="italic">Not provided</span>';
            }
            const displayUrl = url.replace('https://', '').replace('www.', '');
            return `<a href="${url}" target="_blank" rel="noopener noreferrer">${displayUrl}</a>`;
        }
        document.addEventListener('DOMContentLoaded', function() {
            // Simulate loading
            setTimeout(() => {
                const currentUser = JSON.parse(localStorage.getItem('currentUser'));
                if (!currentUser || currentUser.role !== 'student') {
                    window.location.href = '/login-student';
                    return;
                }
                // Student name
                document.getElementById('student-name').textContent = `${currentUser.firstName || 'Student'} ${currentUser.lastName || ''}`;
                // Personal info
                const personalInfoHtml = [
                    createDetailItem('✉️', 'Email', currentUser.email || 'N/A'),
                    createDetailItem('🆔', 'Student ID', currentUser.studentDetails?.studentId || 'N/A'),
                    createDetailItem('🏢', 'Department', currentUser.studentDetails?.department || 'N/A'),
                    createDetailItem('📚', 'Major', currentUser.studentDetails?.major || 'N/A'),
                    createDetailItem('🎓', 'Graduation Year', currentUser.studentDetails?.graduationYear || 'N/A'),
                    createDetailItem('💼', 'LinkedIn', renderSocialLink(currentUser.studentDetails?.linkedin, 'LinkedIn', 'blue'), 'blue'),
                    createDetailItem('🐙', 'GitHub', renderSocialLink(currentUser.studentDetails?.github, 'GitHub', 'gray'), 'gray'),
                    createDetailItem('🌐', 'Portfolio', renderSocialLink(currentUser.studentDetails?.portfolio, 'Portfolio', 'peru'), 'peru')
                ].join('');
                document.getElementById('personal-info').innerHTML = personalInfoHtml;
                // Registered events
                const eventsHtml = currentUser.registeredEvents && currentUser.registeredEvents.length > 0 ?
                    currentUser.registeredEvents.map(event => 
                        createContentItem(
                            `Registered: ${event.name || 'Unnamed Event'}`,
                            `Status: ${event.status || 'N/A'} | Date: ${event.date || 'N/A'}`,
                            'View Details',
                            `viewEventDetails(${event.id || 0})`
                        )
                    ).join('') :
                    createPlaceholderItem("You haven't registered for any events yet.");
                document.getElementById('registered-events').innerHTML = eventsHtml;
                // Joined clubs
                const clubsHtml = currentUser.joinedClubs && currentUser.joinedClubs.length > 0 ?
                    currentUser.joinedClubs.map(club => 
                        createContentItem(
                            `Member: ${club.name || 'Unnamed Club'}`,
                            `Role: ${club.role || 'Member'}`,
                            'Go to Club Page',
                            `navigateToClub('${club.id || ''}')`
                        )
                    ).join('') :
                    createPlaceholderItem("You haven't joined any clubs yet. Explore the clubs directory!");
                document.getElementById('joined-clubs').innerHTML = clubsHtml;
                // Active projects
                const projectsHtml = currentUser.activeProjects && currentUser.activeProjects.length > 0 ?
                    currentUser.activeProjects.map(project => 
                        createContentItem(
                            project.name || 'Unnamed Project',
                            `Your Role: ${project.role || 'Contributor'}`,
                            project.detailsLink ? 'View Project' : null,
                            project.detailsLink ? `viewProject('${project.detailsLink}')` : null
                        )
                    ).join('') :
                    createPlaceholderItem("You are not currently active in any projects. Find one to collaborate on!");
                document.getElementById('active-projects').innerHTML = projectsHtml;
                // Hide loading, show main
                if (document.getElementById('loading')) document.getElementById('loading').style.display = 'none';
                document.getElementById('main-content').style.display = 'block';
            }, 500);
            // Logout
            document.addEventListener('click', function(e) {
                if (e.target && e.target.id === 'logoutButton') {
                    e.preventDefault();
                    localStorage.removeItem('authToken');
                    localStorage.removeItem('currentUser');
                    window.location.href = '/welcome';
                }
            });
            // Edit profile
            document.getElementById('editProfileButton').addEventListener('click', function(e) {
                e.preventDefault();
                window.location.href = '/edit-student-profile';
            });
        });
        function viewEventDetails(eventId) {
            alert(`Redirecting to details for event ID: ${eventId}. (Page to be implemented)`);
        }
        function navigateToClub(clubId) {
            alert(`Navigating to club: ${clubId}. (Functionality depends on clubs directory)`);
            window.location.href = `/clubs-directory#${clubId}`;
        }
        function viewProject(projectLink) {
            alert(`Opening project: ${projectLink}`);
            // In a real app: window.location.href = projectLink;
        }
    </script>
</body>
</html>